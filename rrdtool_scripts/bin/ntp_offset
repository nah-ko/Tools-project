#!/bin/sh
# Creation graph offset NTP

# $Id$

source ../Common
I=0
for F in $(ls ../data/$HOST.*ntp.*.rrd)
do
    NTPINFO=`basename $F .rrd | sed -e 's:^.*ntp_::g'`
    RRDFILE=$F
    if [ -e $RRDFILE ]
    then
	# Definitions
	DEFS="DEF:ligne$I=$RRDFILE:offset:AVERAGE "$DEFS
	INFOS="LINE2:ligne$I#${COLORS[$I]}:$MAILINFO\: \
	       GPRINT:ligne$I:LAST:%8.0lf\n \
	       GPRINT:ligne$I:MIN:Minimum\:%8.0lf \
	       GPRINT:ligne$I:AVERAGE:Moyenne\:%8.0lf \
	       GPRINT:ligne$I:MAX:Maximum\:%8.0lf\n "$INFOS
	I=`expr $I + 1`
    fi
done

#-------------------------------------------
# Offset NTP
#-------------------------------------------
LEGENDE="secondes"
GRAPHFILE=$HOST.net.ntp_offset

for VAR in $LISTE
do
	TITRE="Offset NTP sur $VAR"
	GRAPH=$GRAPHDIR/$GRAPHFILE.$VAR.png
	START=e-$VAR
	# Creation du graph
	rrdtool graph $GRAPH -s $START $OPTIONS --title="$TITRE" -v "$LEGENDE" $DEFS $INFOS\
	COMMENT:"$STR_DATE\c"
done
